
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä–º—ã —Ä–∞—Å—Ö–æ–¥–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
            font-size: 1.1em;
        }

        select, input[type="number"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }

        .area-input-group {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 10px;
            align-items: end;
        }

        .calculate-btn, .buy-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s ease;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .calculate-btn:hover, .buy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .calculate-btn:active, .buy-btn:active {
            transform: translateY(-1px);
        }

        .buy-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            margin-top: 15px;
        }

        .buy-btn:hover {
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.4);
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            border-left: 5px solid #667eea;
            display: none;
        }

        .results.show {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-item:last-child {
            margin-bottom: 0;
        }

        .result-label {
            font-weight: 600;
            color: #333;
        }

        .result-value {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
        }

        .info-text, .features-text {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 0.9em;
            color: #555;
            border-left: 4px solid #667eea;
        }

        .warning-text {
            color: #dc3545;
            font-weight: 600;
            text-align: center;
            margin-top: 20px;
            font-size: 0.95em;
        }

        .contact-text {
            color: #666;
            text-align: center;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .disabled {
            opacity: 0.5;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä–º—ã —Ä–∞—Å—Ö–æ–¥–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        </h1>
        
        <form id="calculatorForm">
            <div class="form-group">
                <label for="category">1. –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤:</label>
                <select id="category" required disabled>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                </select>
            </div>

            <div class="form-group">
                <label for="pesticide">2. –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:</label>
                <select id="pesticide" required disabled>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                </select>
            </div>

            <div class="form-group">
                <label for="culture">3. –ö—É–ª—å—Ç—É—Ä–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–π –æ–±—ä–µ–∫—Ç:</label>
                <select id="culture" required disabled>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç</option>
                </select>
            </div>

            <div class="form-group">
                <label for="harmfulObject">4. –í—Ä–µ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç:</label>
                <select id="harmfulObject" required disabled>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫—É–ª—å—Ç—É—Ä—É</option>
                </select>
            </div>

            <div class="form-group">
                <label for="intensity">5. –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:</label>
                <select id="intensity" required disabled>
                    <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>
                </select>
            </div>

            <div class="form-group">
                <label for="area">6. –ü–ª–æ—â–∞–¥—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:</label>
                <div class="area-input-group">
                    <input type="number" id="area" step="0.01" min="0.01" required>
                    <select id="areaUnit">
                        <option value="ha">–≥–∞</option>
                        <option value="m2">–º¬≤</option>
                        <option value="sotka">—Å–æ—Ç–∫–∏</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="tankVolume">7. –û–±—ä–µ–º –±–∞–∫–∞ –æ–ø—Ä—ã—Å–∫–∏–≤–∞—Ç–µ–ª—è (–ª):</label>
                <input type="number" id="tankVolume" step="0.1" min="0.1" required>
            </div>

            <button type="submit" class="calculate-btn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
        </form>

        <div id="results" class="results">
            <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞:</h3>
            <div class="result-item">
                <span class="result-label">–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:</span>
                <span id="totalPesticide" class="result-value">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—Ç–≤–æ—Ä–∞:</span>
                <span id="totalSolution" class="result-value">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–∞–≤–æ–∫ –±–∞–∫–∞:</span>
                <span id="tankRefills" class="result-value">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">–ü—Ä–µ–ø–∞—Ä–∞—Ç–∞ –Ω–∞ –æ–¥–Ω—É –∑–∞–ø—Ä–∞–≤–∫—É:</span>
                <span id="pesticidePerTank" class="result-value">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:</span>
                <span id="treatmentCost" class="result-value">-</span>
            </div>
            <div class="features-text" id="applicationFeatures">
                –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞
            </div>
            <div class="info-text" id="additionalInfo">
                –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞
            </div>
            <div class="info-text" id="analogsInfo">
                –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–Ω–∞–ª–æ–≥–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞
            </div>
            <a id="buyButton" href="#" target="_blank" class="buy-btn" style="display: none;">
                üõí –ö—É–ø–∏—Ç—å –ø—Ä–µ–ø–∞—Ä–∞—Ç
            </a>
            
            <div class="warning-text">
                ‚ö†Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ! –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏
            </div>
            <div class="contact-text">
                –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –º–æ–∂–Ω–æ –ø—Ä–∏—Å—ã–ª–∞—Ç—å –Ω–∞ agroshop-24@yandex.ru —Å –ø–æ–º–µ—Ç–∫–æ–π "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä–º—ã —Ä–∞—Å—Ö–æ–¥–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤"
            </div>
        </div>
    </div>

    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ –∏–∑ PDF —Ñ–∞–π–ª–∞
        // –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV
        let pesticideData = {}; // –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–∞–Ω–Ω—ã—Ö

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function populateCategories() {
            const categories = new Set();
            for (const product in pesticideData) {
                categories.add(pesticideData[product].category);
            }

            categorySelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>';
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });

            categorySelect.disabled = false;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ data.json
        async function loadJSON() {
            try {
                const response = await fetch('data.json'); // —Ñ–∞–π–ª —Ä—è–¥–æ–º —Å HTML
                if (!response.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å data.json');
                pesticideData = await response.json();
                populateCategories();
                console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ JSON:', pesticideData);
            } catch (error) {
                console.error(error);
            }
        }

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const categorySelect = document.getElementById('category');
        const pesticideSelect = document.getElementById('pesticide');
        const cultureSelect = document.getElementById('culture');
        const harmfulObjectSelect = document.getElementById('harmfulObject');
        const intensitySelect = document.getElementById('intensity');
        const areaInput = document.getElementById('area');
        const areaUnitSelect = document.getElementById('areaUnit');
        const tankVolumeInput = document.getElementById('tankVolume');
        const resultsDiv = document.getElementById('results');
        const form = document.getElementById('calculatorForm');
        const buyButton = document.getElementById('buyButton');
        const treatmentCostElement = document.getElementById('treatmentCost');

        async function fetchProductPrice(productUrl) {
            if (!productUrl) return null;
            try {
                const response = await fetch(`${productUrl}.json`);
                if (!response.ok) throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É –¥–ª—è ${productUrl}`);
                const data = await response.json();
                const price = Number(data?.product?.price_min);
                return Number.isFinite(price) ? price : null;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ü–µ–Ω—ã –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:', error);
                return null;
            }
        }

        // –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
        const intensityOptions = {
            'minimum': { label: '–ú–∏–Ω–∏–º—É–º', value: 'minimum' },
            'medium': { label: '–°—Ä–µ–¥–Ω–µ–µ', value: 'medium' },
            'maximum': { label: '–ú–∞–∫—Å–∏–º—É–º', value: 'maximum' }
        };

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        categorySelect.addEventListener('change', updatePesticideOptions);
        pesticideSelect.addEventListener('change', updateCultureOptions);
        cultureSelect.addEventListener('change', updateHarmfulObjectOptions);
        harmfulObjectSelect.addEventListener('change', updateIntensityOptions);
        form.addEventListener('submit', calculateResults);

        function updatePesticideOptions() {
            const category = categorySelect.value;
            pesticideSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç</option>';
            cultureSelect.innerHTML = '<option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç</option>';
            harmfulObjectSelect.innerHTML = '<option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫—É–ª—å—Ç—É—Ä—É</option>';
            intensitySelect.innerHTML = '<option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>';
            
            if (category) {
                pesticideSelect.disabled = false;
                const pesticides = Object.keys(pesticideData).filter(key => pesticideData[key].category === category).sort();
                
                for (const pesticide of pesticides) {
                    const option = document.createElement('option');
                    option.value = pesticide;
                    option.textContent = pesticide;
                    pesticideSelect.appendChild(option);
                }
            } else {
                pesticideSelect.disabled = true;
                cultureSelect.disabled = true;
                harmfulObjectSelect.disabled = true;
                intensitySelect.disabled = true;
            }
        }

        function updateCultureOptions() {
            const pesticide = pesticideSelect.value;
            cultureSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫—É–ª—å—Ç—É—Ä—É/–æ–±—ä–µ–∫—Ç</option>';
            harmfulObjectSelect.innerHTML = '<option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫—É–ª—å—Ç—É—Ä—É</option>';
            intensitySelect.innerHTML = '<option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>';
            
            if (pesticide && pesticideData[pesticide]) {
                cultureSelect.disabled = false;
                const cultures = Object.keys(pesticideData[pesticide].cultures).sort();
                
                for (const culture of cultures) {
                    const option = document.createElement('option');
                    option.value = culture;
                    option.textContent = culture;
                    cultureSelect.appendChild(option);
                }
            } else {
                cultureSelect.disabled = true;
                harmfulObjectSelect.disabled = true;
                intensitySelect.disabled = true;
            }
        }

        function updateHarmfulObjectOptions() {
            const pesticide = pesticideSelect.value;
            const culture = cultureSelect.value;
            harmfulObjectSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>';
            intensitySelect.innerHTML = '<option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>';
            
            if (pesticide && culture && pesticideData[pesticide].cultures[culture]) {
                harmfulObjectSelect.disabled = false;
                const harmfulObjects = Object.keys(pesticideData[pesticide].cultures[culture]).sort();
                
                for (const harmfulObject of harmfulObjects) {
                    const option = document.createElement('option');
                    option.value = harmfulObject;
                    option.textContent = harmfulObject;
                    harmfulObjectSelect.appendChild(option);
                }
            } else {
                harmfulObjectSelect.disabled = true;
                intensitySelect.disabled = true;
            }
        }

        function updateIntensityOptions() {
            const harmfulObject = harmfulObjectSelect.value;
            intensitySelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏</option>';
            
            if (harmfulObject) {
                intensitySelect.disabled = false;
                
                for (const intensity in intensityOptions) {
                    const option = document.createElement('option');
                    option.value = intensity;
                    option.textContent = intensityOptions[intensity].label;
                    intensitySelect.appendChild(option);
                }
            } else {
                intensitySelect.disabled = true;
            }
        }

        function convertAreaToHa(area, unit) {
            switch (unit) {
                case 'ha': return area;
                case 'm2': return area / 10000;
                case 'sotka': return area / 100;
                default: return area;
            }
        }

        function formatArea(area, unit) {
            switch (unit) {
                case 'ha': return `${area} –≥–∞`;
                case 'm2': return `${area} –º¬≤`;
                case 'sotka': return `${area} —Å–æ—Ç–æ–∫`;
                default: return `${area} ${unit}`;
            }
        }

        function calculateIntensityValues(objectData, intensity) {
            let rate, liquidRate;
            
            switch (intensity) {
                case 'minimum':
                    rate = objectData.minRate;
                    liquidRate = objectData.maxLiquid; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∂–∏–¥–∫–æ—Å—Ç—å –¥–ª—è –º–∏–Ω–∏–º—É–º–∞
                    break;
                case 'maximum':
                    rate = objectData.maxRate;
                    liquidRate = objectData.minLiquid; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∂–∏–¥–∫–æ—Å—Ç—å –¥–ª—è –º–∞–∫—Å–∏–º—É–º–∞
                    break;
                case 'medium':
                default:
                    rate = objectData.avgRate;
                    liquidRate = objectData.avgLiquid;
                    break;
            }
            
            return { rate, liquidRate };
        }

        async function calculateResults(e) {
            e.preventDefault();
            
            const category = categorySelect.value;
            const pesticide = pesticideSelect.value;
            const culture = cultureSelect.value;
            const harmfulObject = harmfulObjectSelect.value;
            const intensity = intensitySelect.value;
            const area = parseFloat(areaInput.value);
            const areaUnit = areaUnitSelect.value;
            const tankVolume = parseFloat(tankVolumeInput.value);
            
            if (!category || !pesticide || !culture || !harmfulObject || !intensity || !area || !tankVolume) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            const pesticideInfo = pesticideData[pesticide];
            const objectData = pesticideInfo.cultures[culture][harmfulObject];
            const { rate, liquidRate } = calculateIntensityValues(objectData, intensity);
            const areaInHa = convertAreaToHa(area, areaUnit);
            
            // –†–∞—Å—á–µ—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –∏ —Ä–∞—Å—Ç–≤–æ—Ä–∞
            const totalPesticide = areaInHa * rate;
            const totalSolution = areaInHa * liquidRate;

            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
            const isKg = objectData.unit.includes('–∫–≥');
            
            // –†–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–∞–≤–æ–∫ –∏ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –Ω–∞ –∑–∞–ø—Ä–∞–≤–∫—É
            const tankRefills = Math.ceil(totalSolution / tankVolume);
            const pesticidePerTank = totalPesticide / tankRefills;
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –µ–¥–∏–Ω–∏—Ü–∞–º–∏
            function formatPesticideAmount(amount, isKg) {
                if (amount < 1) {
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –º–ª/–º–≥
                    const smallAmount = amount * 1000;
                    const unit = isKg ? '–º–≥' : '–º–ª';
                    return `${smallAmount.toFixed(1)} ${unit}`;
                } else {
                    // –û—Å—Ç–∞–≤–ª—è–µ–º –≤ –∫–≥/–ª
                    const unit = isKg ? '–∫–≥' : '–ª';
                    return `${amount.toFixed(3)} ${unit}`;
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫–ª–æ–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞ "–≥–æ–¥"
            function getYearWord(years) {
                if (years % 10 === 1 && years % 100 !== 11) {
                    return '–≥–æ–¥';
                } else if ([2, 3, 4].includes(years % 10) && ![12, 13, 14].includes(years % 100)) {
                    return '–≥–æ–¥–∞';
                } else {
                    return '–ª–µ—Ç';
                }
            }

            function formatMoAValues(value) {
                if (value === null || value === undefined) return '‚Äî';
                if (Array.isArray(value)) return value.join(', ');
                return value.toString();
            }

            function getMoALabelByCategory(categoryName) {
                const normalized = (categoryName || '').toLowerCase();

                if (normalized.includes('—Ñ—É–Ω–≥–∏—Ü')) return 'FRAC - –∫–æ–¥';
                if (normalized.includes('–∏–Ω—Å–µ–∫—Ç–∏—Ü')) return 'IRAC - –∫–æ–¥';
                if (normalized.includes('–≥–µ—Ä–±–∏—Ü')) return 'HRAC - –∫–æ–¥';

                return 'MoA - –∫–æ–¥';
            }

            function normalizeFormValue(formValue) {
                if (!formValue) return '';

                const normalized = formValue
                    .toString()
                    .trim()
                    .toLowerCase()
                    .replace(/\s+/g, ' ');

                const formSynonyms = {
                    '–∫—Å (–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å—É—Å–ø–µ–Ω–∑–∏–∏)': '–∫—Å/—Å–∫ (–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å—É—Å–ø–µ–Ω–∑–∏–∏)',
                    '—Å–∫ (—Å—É—Å–ø–µ–Ω–∑–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç)': '–∫—Å/—Å–∫ (–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å—É—Å–ø–µ–Ω–∑–∏–∏)'
                };

                return formSynonyms[normalized] || normalized;
            }

            function formsAreEquivalent(formA, formB) {
                return normalizeFormValue(formA) === normalizeFormValue(formB);
            }

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById('totalPesticide').textContent =
                formatPesticideAmount(totalPesticide, isKg);
            document.getElementById('totalSolution').textContent =
                `${totalSolution.toFixed(1)} –ª`;
            document.getElementById('tankRefills').textContent = 
                `${tankRefills} ${tankRefills === 1 ? '–∑–∞–ø—Ä–∞–≤–∫–∞' : '–∑–∞–ø—Ä–∞–≤–æ–∫'}`;
            document.getElementById('pesticidePerTank').textContent =
                formatPesticideAmount(pesticidePerTank, isKg);

            // –°—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
            treatmentCostElement.textContent = '‚Äî';
            const packagingVolume = Number(pesticideInfo.packaging);
            const pricePerPackage = await fetchProductPrice(pesticideInfo.url);

            if (Number.isFinite(packagingVolume) && packagingVolume > 0 && pricePerPackage !== null) {
                const pricePerUnit = pricePerPackage / packagingVolume;
                const costPerTank = pesticidePerTank * pricePerUnit;
                const totalCost = costPerTank * tankRefills;
                treatmentCostElement.textContent = `${totalCost.toFixed(2)} ‚ÇΩ`;
            } else {
                treatmentCostElement.textContent = '–Ω/–¥';
            }
                
            // –†–∞—Å—á–µ—Ç –Ω–æ—Ä–º—ã —Ä–∞—Å—Ö–æ–¥–∞ –Ω–∞ 10–ª –∂–∏–¥–∫–æ—Å—Ç–∏
            let rateFor10L, rateUnit;
            if (objectData.unit.includes('–∫–≥')) {
                rateFor10L = (rate / liquidRate * 1000) * 10; // –≤ –≥—Ä–∞–º–º–∞—Ö
                rateUnit = '–≥/10 –ª';
            } else {
                rateFor10L = (rate / liquidRate * 1000) * 10; // –≤ –º–ª
                rateUnit = '–º–ª/10 –ª';
            }

            // –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤
            const currentIngredients = pesticideInfo.activeIngredients || {}; // –æ–±—ä–µ–∫—Ç { –≤–µ—â–µ—Å—Ç–≤–æ: –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è }

            const fullAnalogs = [];
            const differentConcentrationAnalogs = [];
            const similarPreparations = [];
            const alternatives = [];

            const currentForm = normalizeFormValue(pesticideInfo.form);
            const currentIngredientKeys = Object.keys(currentIngredients).sort();

            for (const productName in pesticideData) {
                if (productName === pesticide) continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–∞–º –ø—Ä–µ–ø–∞—Ä–∞—Ç
                const product = pesticideData[productName];
                const ingredients = product.activeIngredients || {};
                const productForm = normalizeFormValue(product.form);

                // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–∞–±–æ—Ä—ã –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤
                const otherKeys = Object.keys(ingredients).sort();

                const sameIngredients = JSON.stringify(currentIngredientKeys) === JSON.stringify(otherKeys);
                const shareAtLeastOneIngredient = currentIngredientKeys.some(key => otherKeys.includes(key));
                const formsEquivalent = formsAreEquivalent(currentForm, productForm);

                if (formsEquivalent && sameIngredients) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏
                    let allSame = true;
                    for (const key of currentIngredientKeys) {
                        if (currentIngredients[key] !== ingredients[key]) {
                            allSame = false;
                            break;
                        }
                    }

                    if (allSame) {
                        fullAnalogs.push({ name: productName, url: product.url });
                    } else {
                        differentConcentrationAnalogs.push({ name: productName, url: product.url });
                    }

                    continue;
                }

                if (formsEquivalent && shareAtLeastOneIngredient) {
                    similarPreparations.push({ name: productName, url: product.url });
                    continue;
                }

                if (shareAtLeastOneIngredient) {
                    alternatives.push({ name: productName, url: product.url });
                }
            }

            // –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
            const applicationFeatures = document.getElementById('applicationFeatures');
            applicationFeatures.innerHTML = `
                <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:</strong><br>
                ${objectData.features}<br><br>
                ‚Ä¢ –ù–æ—Ä–º–∞ —Ä–∞—Å—Ö–æ–¥–∞: ${rateFor10L.toFixed(1)} ${rateUnit}<br>
                ‚Ä¢ –†–∞—Å—Ö–æ–¥ —Ä–∞–±–æ—á–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏: ${liquidRate.toFixed(0)} –ª/–≥–∞<br>
                ‚Ä¢ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–∞—è –ø–ª–æ—â–∞–¥—å: ${formatArea(area, areaUnit)}
            `;
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            const additionalInfo = document.getElementById('additionalInfo');
            const packagingUnit = isKg ? '–∫–≥' : '–ª';
            const concentrationUnit = isKg ? '–≥/–∫–≥' : '–≥/–ª';
            const activeIngredientsData = pesticideInfo.activeIngredients || {};
            const ingredientsList = Object.entries(activeIngredientsData)
                .map(([name, conc]) => `${name} ${conc} ${concentrationUnit}`)
                .join(', ');
            const ingredientsText = ingredientsList || '‚Äî';
            const chemicalClass = pesticideInfo.chemicalClass || pesticideInfo.chemical–°lass || '‚Äî';
            const moALabel = getMoALabelByCategory(pesticideInfo.category || objectData.category || '');
            const moAFormatted = formatMoAValues(pesticideInfo.moA);
            additionalInfo.innerHTML = `
                <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–µ:</strong><br>
                ‚Ä¢ –§–æ—Ä–º–∞: ${pesticideInfo.form}<br>
                ‚Ä¢ –î–µ–π—Å—Ç–≤—É—é—â–µ–µ –≤–µ—â–µ—Å—Ç–≤–æ: ${ingredientsText}<br>
                ‚Ä¢ –•–∏–º–∏—á–µ—Å–∫–∏–π –∫–ª–∞—Å—Å: ${chemicalClass}<br>
                ‚Ä¢ ${moALabel}: ${moAFormatted}<br>
                ‚Ä¢ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å: ${pesticideInfo.manufactory}<br>
                ‚Ä¢ –°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏: ${pesticideInfo.expirationDate} ${getYearWord(pesticideInfo.expirationDate)}<br>
                ‚Ä¢ –£–ø–∞–∫–æ–≤–∫–∞: ${pesticideInfo.packaging} ${packagingUnit}
            `;

            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–Ω–∞–ª–æ–≥–∞—Ö
            const analogsInfo = document.getElementById('analogsInfo');
            let analogsHTML = '<strong>–ê–Ω–∞–ª–æ–≥–∏ –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:</strong><br>';

            if (fullAnalogs.length > 0) {
                const analogLinks = fullAnalogs.map(analog =>
                    `<a href="${analog.url}" target="_blank" style="color: #667eea; text-decoration: underline;">${analog.name}</a>`
                ).join(', ');
                analogsHTML += `‚Ä¢ üü¢ –ü–æ–ª–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏: ${analogLinks}<br>`;
            } else {
                analogsHTML += '‚Ä¢ üü¢ –ü–æ–ª–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã<br>';
            }

            if (differentConcentrationAnalogs.length > 0) {
                const analogLinks = differentConcentrationAnalogs.map(analog =>
                    `<a href="${analog.url}" target="_blank" style="color: #667eea; text-decoration: underline;">${analog.name}</a>`
                ).join(', ');
                analogsHTML += `‚Ä¢ üü° –†–∞–∑–Ω–æ–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏: ${analogLinks}<br>`;
            } else {
                analogsHTML += '‚Ä¢ üü° –†–∞–∑–Ω–æ–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã<br>';
            }

            if (similarPreparations.length > 0) {
                const similarLinks = similarPreparations.map(analog =>
                    `<a href="${analog.url}" target="_blank" style="color: #667eea; text-decoration: underline;">${analog.name}</a>`
                ).join(', ');
                analogsHTML += `‚Ä¢ üü† –°—Ö–æ–∂–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã: ${similarLinks}<br>`;
            } else {
                analogsHTML += '‚Ä¢ üü† –°—Ö–æ–∂–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã<br>';
            }

            if (alternatives.length > 0) {
                const alternativeLinks = alternatives.map(analog =>
                    `<a href="${analog.url}" target="_blank" style="color: #667eea; text-decoration: underline;">${analog.name}</a>`
                ).join(', ');
                analogsHTML += `‚Ä¢ üî¥ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: ${alternativeLinks}<br>`;
            } else {
                analogsHTML += '‚Ä¢ üî¥ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã<br>';
            }

            analogsInfo.innerHTML = analogsHTML;
            
            // –ö–Ω–æ–ø–∫–∞ –ø–æ–∫—É–ø–∫–∏
            buyButton.href = pesticideInfo.url;
            buyButton.style.display = 'block';
            
            resultsDiv.classList.add('show');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }
    
        // –≤—ã–∑–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏
        loadJSON();
    </script>
</body>
</html>
